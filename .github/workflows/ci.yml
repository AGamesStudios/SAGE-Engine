name: CI
on: [push, pull_request]

jobs:
  minimal:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev,audio_conv]
      - run: ruff check .
      - run: pytest -q

  qt6:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev,audio_conv,qt6]
      - run: ruff check .
      - run: pytest -q

  tk:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev,audio_conv,tk]
      - run: ruff check .
      - run: pytest tests/gui/test_auto_load.py -q

  particles_headless:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev]
      - run: ruff check .
      - run: pytest tests/test_ink.py -q

  render_opengl:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev,opengl]
      - run: ruff check .
      - run: pytest tests/render/test_opengl_basic.py -q

  fx_demo_screenshot:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: python -m pip install .[dev]
      - run: ruff check .
      - run: pytest tests/test_fx_demo.py -q
